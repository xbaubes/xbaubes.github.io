<!doctype html>
<html lang="ca">
<head>
  <meta charset="utf-8">
  <title>Formulari Web â†’ Apps Script</title>
</head>
<body>
  <h2>Enviar dades a Google Apps Script</h2>
  
  <label>
    Nom:
    <input type="text" id="nom" required>
  </label>
  <br><br>
  
  <label>
    Correu:
    <input type="email" id="correu" required>
  </label>
  <br><br>
  
  <label>
    Categoria:
    <select id="categoria" required>
      <option value="">-- Selecciona --</option>
      <option value="A">A</option>
      <option value="B">B</option>
      <option value="C">C</option>
    </select>
  </label>
  <br><br>
  
  <button id="btn">Enviar</button>
  
  <pre id="out"></pre>

  <script>
    const ENDPOINT = "https://script.google.com/macros/s/AKfycbyi0w2ApCouWmQOsSe1b45V89DMyXhFKd36wcO1QzhLlfgAJ4zzVqpuw7FDyCKDj3NLdg/exec";
    const out = document.getElementById("out");

    document.getElementById("btn").addEventListener("click", enviar);

    async function enviar() {
      // ðŸ“Œ Agafar valors dels inputs
      const nom = document.getElementById("nom").value.trim();
      const correu = document.getElementById("correu").value.trim();
      const categoria = document.getElementById("categoria").value;

      // ValidaciÃ³ bÃ sica
      if (!nom || !correu || !categoria) {
        alert("Omple tots els camps abans d'enviar.");
        return;
      }

      // Construir dades en format x-www-form-urlencoded
      const params = new URLSearchParams();
      params.append("nom", nom);
      params.append("correu", correu);
      params.append("categoria", categoria);

      try {
        const res = await fetch(ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: params.toString()
        });

        const text = await res.text();
        let data;
        try { data = JSON.parse(text); }
        catch { data = { raw: text }; }

        out.textContent = JSON.stringify({ status: res.status, data }, null, 2);
      } catch (err) {
        out.textContent = "Error de xarxa: " + err.message;
      }
    }
  </script>
</body>
</html>
